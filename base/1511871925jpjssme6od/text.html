<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'MS Shell Dlg 2'; font-size:9pt; font-weight:400; font-style:normal;">
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Sub</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> test_FnDicInAr</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngClnStart </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngClnEnd </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngRowStart </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngRowEnd </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> aTemp </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Variant</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">lngClnStart </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">lngRowStart </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">2</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">With</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> ThisWorkbook</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">With</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Sheets</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;ListZonePSFV&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            lngClnEnd </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Cells</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">256</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">xlToLeft</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Column</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            lngRowEnd </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Columns</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Rows</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">65536</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">xlUp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Row</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            aTemp </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Range</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Cells</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">lngRowStart</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngClnStart</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">),</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">.</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Cells</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">lngRowEnd</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngClnEnd</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)).</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">Value</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">With</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">With</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dicZone_DEPT </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicInAr</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">4</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dicZone_UET </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicInAr</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">6</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dicZone_Time_A </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicInAr</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">10</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> dicZone_Time_C </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicInAr</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">11</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'====================================================================================================</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">' ##### словарь из двумерного(Одномерного) массива</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'----------------------------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Function</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicInAr</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> aTemp </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Variant</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngClnKey </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> _</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">ByVal</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> lngClnItem </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Object</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">                    </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Object</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> strPi </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">String</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> iNbCln1 </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Integer</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'первый столбец</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> iNbCln2 </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Integer</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'второй столбец</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">On</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Error</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Resume</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">iNbCln1 </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> LBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'iNbCln2 = UBound(aTemp, 2)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">iNbCln2 </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> RazmerArray</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'If iNbCln1 &lt;&gt; iNbCln2 Then Stop</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> CreateObject</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#808080;">&quot;scripting.dictionary&quot;</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">):</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi.comparemode </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">For</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> i </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> LBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">To</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> UBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> iNbCln1 </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> iNbCln2 </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Then</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">  </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'если два столбца</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            strKey </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Trim</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">))</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Not</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi.exists</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">strKey</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Then</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi.Add strKey</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> strKey</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Else</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            strKey </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Trim</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> iNbCln1</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">))</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            strItem </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> Trim</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">aTemp</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">i</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> iNbCln2</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">))</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">            </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Not</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi.exists</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">strKey</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Then</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi.Add strKey</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> strItem</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Next</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'j</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Set</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicInAr </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> FnDicPi</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Function</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'----------------------------------------------------------------------------------------------------</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''http://www.planetaexcel.ru/forum/?PAGE_NAME=read&amp;FID=8&amp;TID=25891</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''вообще-то верхняя граница может быть любой...( в том числе и отрицательной)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''я б сделал так:</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Function</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> RazmerArray</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">A</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Dim</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> k </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">As</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">On</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Error</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">GoTo</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> KOH</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    j </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> LBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">A</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    k </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> j </span><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">While</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> UBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">A</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> k</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">&gt;=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> LBound</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">(</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">A</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">,</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> k</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        k </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> k </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">+</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Wend</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">KOH</span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">:</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> k </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">0</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Then</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        RazmerArray </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">0</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Else</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">        RazmerArray </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">=</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> k </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#000000;">-</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; font-weight:600; color:#ff0000;">1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">    </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">If</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">End</span><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span><span style=" font-family:'Courier New'; font-size:10pt; color:#0000ff;">Function</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Sub test()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    Dim Arr(4, 6, 3, 9)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    For i = 1 To 60</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''        On Error Resume Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''        tmp = UBound(Arr, i)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''        If Err.Number &gt; 0 Then MsgBox i - 1: Exit For:</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    Next</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'====================================================================================================</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'''вот вам мерседец :)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Declare Function VarPtrArray Lib &quot;msvbvm60.dll&quot; Alias &quot;VarPtr&quot; (Var() As Any) As Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Declare Sub GetMem4 Lib &quot;msvbvm60.dll&quot; (ByVal SrcPointer As Long, ByVal DstPointer As Long)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Sub t()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Dim ar(1, 2, 3, 4, 5, 6, 7)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Dim p&amp;, dm As Integer</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''GetMem4 VarPtrArray(ar()), VarPtr(p)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''GetMem4 p, VarPtr(dm)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">'''msgbox &quot;вы объявили &quot;&amp; p &quot;измерений&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''''а точнее( а главное безопаснее):</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Option Explicit</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Option Base 0</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Declare Function VarPtrArray Lib &quot;msvbvm60.dll&quot; Alias &quot;VarPtr&quot; (Var() As Any) As Long</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Declare Sub GetMem4 Lib &quot;msvbvm60.dll&quot; (ByVal SrcPointer As Long, ByVal DstPointer As Long)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Sub t()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    Dim ar(1, 2, 3, 4, 5, 6, 7)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    Dim p&amp;, dm(1) As Integer</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    GetMem4 VarPtrArray(ar()), VarPtr(p)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    GetMem4 p, VarPtr(dm(0))</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''    MsgBox &quot;вы объявили &quot; &amp; dm(0) &amp; &quot; измерений&quot;</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;"> </span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#000000;">   </span></p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Sub t()</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''   Dim A '(1 To 1, 1 To 1)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''   Debug.Print RazmerArray(A)</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''End Sub</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''''а в мерседеце просто непосредственно берется значение размерности из соответствующей структуры - без всяких циклов..</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''Private Function nDx%(Arr)   'возвращает количество измерений массива Arr</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''  Dim i%, X</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''  On Error GoTo eXX   ' увеличиваем i пока не получим ошибку попытки получить UBound по данному измерению</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''  Do: i = i + 1: X = UBound(Arr, i): Loop</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''eXX:    nDx = i - 1</span> </p>
<p style=" margin-top:12px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; background-color:#ffffff;"><span style=" font-family:'Courier New'; font-size:10pt; color:#008000;">''End Function</span> </p>
<p style=" margin-top:12px; margin-bottom:12px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">  </p></body></html>